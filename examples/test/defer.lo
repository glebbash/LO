@include("../lib/cli.lo")

fn main() {
    defer println("defer(main): 1")
    defer println("defer(main): 2")
    defer println("defer(main): 3")
    inner_fn()
}

fn inner_fn() {
    defer println("defer(inner_fn): top level")
    for i in 0..3 {
        let message = String::from_str("defer(inner_fn): loop (iteration #")
        message.push_str((i + 1).to_tmp_str!())
        message.push_str(")")

        // exprs in loops run after each iteration
        defer println(message.as_str())
    }
    if false {
        // defers won't run if the scope was never entered
        defer println("defer(inner_fn): won't trigger")
    }
}
