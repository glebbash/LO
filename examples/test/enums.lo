@include("../lib/cli.lo")

type Expr = enum (&void) {
    Binary(&ExprBinary),
    Item(&ExprItem),
}

type ExprBinary = struct {
    operator: str,
    lhs: Expr,
    rhs: Expr,
}

type ExprItem = struct {
    name: str,
}

fn main() {
    let expr = Expr::Binary(heap::new!(ExprBinary {
        operator: "+",
        lhs: Expr::Item(heap::new!(ExprItem { name: "a" })),
        rhs: Expr::Item(heap::new!(ExprItem { name: "b" })),
    }))

    if match Expr::Binary(bin) = expr {
        print(bin.operator)

        match Expr::Item(item) = bin.lhs else {
            @unreachable()
        }
        println(item.name)
    }
}
